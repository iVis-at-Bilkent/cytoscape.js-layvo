!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.cytoscapeLayvo=e():t.cytoscapeLayvo=e()}(window,function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){t.exports=function(){let t=this;return{generalProperties:()=>n(t),differenceMetrics:a}};let n=function(t){let e=i(t);return{numberOfEdgeCrosses:o(t),numberOfNodeOverlaps:r(t),totalArea:u(t),totalEdgeLength:e,averageEdgeLength:e/t.edges().length}},o=function(t){let e=0,n=t.edges().toArray();for(let t=0;t<n.length;t++){let a=n[t].sourceEndpoint(),f=n[t].targetEndpoint();for(let l=t+1;l<n.length;l++){let t=n[l].sourceEndpoint(),c=n[l].targetEndpoint();o=a.x,r=a.y,u=f.x,i=f.y,a=t.x,f=t.y,t=c.x,c=c.y,d=void 0,s=void 0,p=void 0,0!=(d=(u-o)*(c-f)-(t-a)*(i-r))&&(s=((r-i)*(t-o)+(u-o)*(c-r))/d,0<(p=((c-f)*(t-o)+(a-t)*(c-r))/d)&&p<1&&0<s&&s<1)&&e++}}var o,r,u,i,a,f,l,c,d,s,p;return e},r=function(t){let e=function(t,e){let n=t.boundingBox(),o=e.boundingBox();return!(o.x1>n.x2||o.x2<n.x1||o.y1>n.y2||o.y2<n.y1)},n=0,o=t.nodes().toArray();for(let t=0;t<o.length;t++){let r=o[t];for(let u=t+1;u<o.length;u++){e(r,o[u])&&n++}}return n},u=function(t){let e=t.elements().boundingBox();return e.w*e.h},i=function(t){let e=function(t,e){let n=e.x-t.x,o=e.y-t.y;return Math.sqrt(n*n+o*o)},n=0,o=t.edges().toArray();for(let t of o){n+=e(t.sourceEndpoint(),t.targetEndpoint())}return n},a=function(t,e){return t.fit(50),e.fit(50),t.zoom()>e.zoom()?(t.zoom(e.zoom()),t.pan(e.pan())):(e.zoom(t.zoom()),e.pan(t.pan())),{averageDistanceBetweenGraphs:f(t,e),orthogonalOrdering:l(t,e)}},f=function(t,e){let n=0,o=0;return t.nodes().forEach(function(t){let r=e.getElementById(t.id());r.length&&(o++,n+=function(t,e){let n=e.x-t.x,o=e.y-t.y;return Math.sqrt(n*n+o*o)}(t.renderedPosition(),r.renderedPosition()))}),o?n/o:0},l=function(t,e){let n=function(t){let e=t.targetEndpoint().x-t.sourceEndpoint().x,n=t.targetEndpoint().y-t.sourceEndpoint().y,o=Math.atan2(e,n);return o<0?o+2*Math.PI:o},o=function(t,e,n){if(t%Math.PI>Math.PI/4){let t=-4/Math.PI,o=2,r=Math.PI/2,u=Math.floor(n/r)-Math.floor(e/r),i=0,a=2+e%r*t,f=2+n%r*t;return u>0?(i=r*(u-1),i+=(r-e%r)*a/2,i+=(o+f)/2*(n%r)):i+=(a+f)/2*((n-e)%r),i}{let t=4/Math.PI,o=2,r=Math.PI/2,u=Math.floor(n/r)-Math.floor(e/r),i=r*Math.floor((n-e)/r),a=e%r*t,f=n%r*t;return u>0?(i=r*(u-1),i+=(r-e%r)*(o+a)/2,i+=f*(n%r)/2):i+=(a+f)/2*((n-e)%r),i}},r=function(t,e){let r=0,u=n(t),i=n(e);u>i&&([u,i]=[i,u]);let a=0;for(;a!=i;)(a=Math.PI/4*(Math.floor(u/(Math.PI/4))+1))>i&&(a=i),u%Math.PI/2>Math.PI/4?r+=o(5,u,a):r+=o(0,u,a),u=a;return r},u=0,i=0;return t.edges().forEach(function(t){let n=e.getElementById(t.id());n.length&&(i++,u+=Math.min(r(t,n),r(n,t)))}),console.log(u),i?u/i:0}},function(t,e,n){const o=n(0);let r=function(t){t&&t("core","layvo",o)};"undefined"!=typeof cytoscape&&r(cytoscape),t.exports=r}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jeXRvc2NhcGVMYXl2by93ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24iLCJ3ZWJwYWNrOi8vY3l0b3NjYXBlTGF5dm8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vY3l0b3NjYXBlTGF5dm8vLi9zcmMvbGF5b3V0LWV2YWx1YXRpb24uanMiLCJ3ZWJwYWNrOi8vY3l0b3NjYXBlTGF5dm8vLi9zcmMvaW5kZXguanMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwid2luZG93IiwiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJ2YWx1ZSIsIm4iLCJfX2VzTW9kdWxlIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiY3kiLCJ0aGlzIiwiZ2VuZXJhbFByb3BlcnRpZXMiLCJkaWZmZXJlbmNlTWV0cmljcyIsInRvdGFsRWRnZUxlbmd0aCIsImdldFRvdGFsRWRnZUxlbmd0aCIsIm51bWJlck9mRWRnZUNyb3NzZXMiLCJmaW5kTnVtYmVyT2ZDcm9zc2VzIiwibnVtYmVyT2ZOb2RlT3ZlcmxhcHMiLCJmaW5kTnVtYmVyT2ZPdmVybGFwcGluZ05vZGVzIiwidG90YWxBcmVhIiwiZ2V0VG90YWxBcmVhIiwiYXZlcmFnZUVkZ2VMZW5ndGgiLCJlZGdlcyIsImxlbmd0aCIsImNyb3NzZXMiLCJlZGdlQXJyYXkiLCJ0b0FycmF5Iiwic291cmNlRW5kcG9pbnQiLCJxIiwidGFyZ2V0RW5kcG9pbnQiLCJqIiwiYSIsIngiLCJiIiwieSIsImRldCIsImdhbW1hIiwibGFtYmRhIiwiZG9lc092ZXJsYXAiLCJub2RlIiwib3RoZXJOb2RlIiwiYmIiLCJib3VuZGluZ0JveCIsImJiT3RoZXIiLCJ4MSIsIngyIiwieTEiLCJ5MiIsIm92ZXJsYXBzIiwibm9kZUFycmF5Iiwibm9kZXMiLCJlbGVtZW50cyIsInciLCJoIiwiZ2V0RGlzdGFuY2UiLCJkeCIsImR5IiwiTWF0aCIsInNxcnQiLCJ0b3RhbExlbmd0aCIsImVkZ2UiLCJvdGhlckN5IiwiZml0Iiwiem9vbSIsInBhbiIsImF2ZXJhZ2VEaXN0YW5jZUJldHdlZW5HcmFwaHMiLCJnZXRBdmVyYWdlRGlzdGFuY2VCZXR3ZWVuR3JhcGhzIiwib3J0aG9nb25hbE9yZGVyaW5nIiwidG90YWxEaXN0YW5jZSIsIm51bWJlck9mTm9kZXMiLCJmb3JFYWNoIiwiZWxlIiwib3RoZXJFbGUiLCJnZXRFbGVtZW50QnlJZCIsImlkIiwicmVuZGVyZWRQb3NpdGlvbiIsImNhbGNFZGdlQW5nbGUiLCJhbmdsZSIsImF0YW4yIiwiUEkiLCJnZXRXZWlnaHQiLCJ0aGV0YSIsImxvd2VyQm91bmQiLCJ1cHBlckJvdW5kIiwic2xvcGUiLCJoZWlnaHQiLCJ3aWR0aCIsImZsb29yIiwiYXJlYSIsImxvd2VyQm91bmRZIiwidXBwZXJCb3VuZFkiLCJnZXRPcmRlciIsIm90aGVyRWRnZSIsInRvdGFsV2VpZ2h0Iiwib3RoZXJBbmdsZSIsInRvdGFsQW5nbGUiLCJudW1iZXJPZkVkZ2VzIiwibWluIiwiY29uc29sZSIsImxvZyIsImltcGwiLCJyZWdpc3RlciIsImN5dG9zY2FwZSJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsRUFBQUMsR0FDQSxpQkFBQUMsU0FBQSxpQkFBQUMsT0FDQUEsT0FBQUQsUUFBQUQsSUFDQSxtQkFBQUcsZUFBQUMsSUFDQUQsVUFBQUgsR0FDQSxpQkFBQUMsUUFDQUEsUUFBQSxlQUFBRCxJQUVBRCxFQUFBLGVBQUFDLElBUkEsQ0FTQ0ssT0FBQSxXQUNELG1CQ1RBLElBQUFDLEtBR0EsU0FBQUMsRUFB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QUtzQixHQUFLLEVBQ25DYyxHQUFlYixFQUFVLEVBQUdILEVBQU9NLEdBRW5DVSxHQUFlYixFQUFVLEVBQUdILEVBQU9NLEdBR3BDTixFQUFRTSxFQUdULE9BQU9VLEdBR0pFLEVBQWEsRUFBR0MsRUFBZ0IsRUFVcEMsT0FSQXZGLEVBQUdhLFFBQVFnRCxRQUFRLFNBQVNDLEdBQzNCLElBQUlDLEVBQVdYLEVBQVFZLGVBQWVGLEVBQUlHLE1BQ3RDRixFQUFTakQsU0FDWnlFLElBQ0FELEdBQWN0QyxLQUFLd0MsSUFBSU4sRUFBU3BCLEVBQUtDLEdBQVdtQixFQUFTbkIsRUFBVUQsT0FHckUyQixRQUFRQyxJQUFJSixHQUNMQyxFQUFnQkQsRUFBYUMsRUFBZ0Isb0JDM01yRCxNQUFNSSxFQUFPdEgsRUFBUSxHQUdyQixJQUFJdUgsRUFBVyxTQUFVQyxHQUNsQkEsR0FFTEEsRUFBVyxPQUFRLFFBQVNGLElBR0wsb0JBQWRFLFdBQ1RELEVBQVVDLFdBR1o3SCxFQUFPRCxRQUFVNkgiLCJmaWxlIjoiY3l0b3NjYXBlLWxheXZvLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW10sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiY3l0b3NjYXBlTGF5dm9cIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wiY3l0b3NjYXBlTGF5dm9cIl0gPSBmYWN0b3J5KCk7XG59KSh3aW5kb3csIGZ1bmN0aW9uKCkge1xucmV0dXJuICIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMSk7XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xuXHRsZXQgY3kgPSB0aGlzO1xuXHRyZXR1cm4ge1xuXHRcdGdlbmVyYWxQcm9wZXJ0aWVzOiAoKT0+e3JldHVybiBnZW5lcmFsUHJvcGVydGllcyhjeSl9LFxuXHRcdGRpZmZlcmVuY2VNZXRyaWNzOiBkaWZmZXJlbmNlTWV0cmljcyxcblx0fTtcbn07XG5cbmxldCBnZW5lcmFsUHJvcGVydGllcyA9IGZ1bmN0aW9uKGN5KSB7XG5cdGxldCB0b3RhbEVkZ2VMZW5ndGggPSBnZXRUb3RhbEVkZ2VMZW5ndGgoY3kpO1xuXHRyZXR1cm4ge1xuXHRcdG51bWJlck9mRWRnZUNyb3NzZXM6IGZpbmROdW1iZXJPZkNyb3NzZXMoY3kpLFxuXHRcdG51bWJlck9mTm9kZU92ZXJsYXBzOiBmaW5kTnVtYmVyT2ZPdmVybGFwcGluZ05vZGVzKGN5KSxcblx0XHR0b3RhbEFyZWE6IGdldFRvdGFsQXJlYShjeSksXG5cdFx0dG90YWxFZGdlTGVuZ3RoOiB0b3RhbEVkZ2VMZW5ndGgsXG5cdFx0YXZlcmFnZUVkZ2VMZW5ndGg6IHRvdGFsRWRnZUxlbmd0aCAvIGN5LmVkZ2VzKCkubGVuZ3RoLFxuXHR9O1xufTtcblxubGV0IGZpbmROdW1iZXJPZkNyb3NzZXMgPSBmdW5jdGlvbihjeSkge1xuXHRsZXQgZG9lc0ludGVyc2VjdCA9IGZ1bmN0aW9uKGEsYixjLGQscCxxLHIscykge1xuXHRcdHZhciBkZXQsIGdhbW1hLCBsYW1iZGE7XG5cdFx0ZGV0ID0gKGMgLSBhKSAqIChzIC0gcSkgLSAociAtIHApICogKGQgLSBiKTtcblx0XHRpZiAoZGV0ID09PSAwKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGxhbWJkYSA9ICgocyAtIHEpICogKHIgLSBhKSArIChwIC0gcikgKiAocyAtIGIpKSAvIGRldDtcblx0XHRcdGdhbW1hID0gKChiIC0gZCkgKiAociAtIGEpICsgKGMgLSBhKSAqIChzIC0gYikpIC8gZGV0O1xuXHRcdFx0cmV0dXJuICgwIDwgbGFtYmRhICYmIGxhbWJkYSA8IDEpICYmICgwIDwgZ2FtbWEgJiYgZ2FtbWEgPCAxKTtcblx0XHR9XG5cdH07XG5cblx0bGV0IGNyb3NzZXMgPSAwO1xuXHRsZXQgZWRnZUFycmF5ID0gY3kuZWRnZXMoKS50b0FycmF5KCk7XG5cblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBlZGdlQXJyYXkubGVuZ3RoOyBpKyspIHtcblx0XHRsZXQgcCA9IGVkZ2VBcnJheVtpXS5zb3VyY2VFbmRwb2ludCgpLCBxID0gZWRnZUFycmF5W2ldLnRhcmdldEVuZHBvaW50KCk7XG5cdFx0Zm9yIChsZXQgaiA9IGkgKyAxOyBqIDwgZWRnZUFycmF5Lmxlbmd0aDsgaisrKSB7XG5cdFx0XHRsZXQgciA9IGVkZ2VBcnJheVtqXS5zb3VyY2VFbmRwb2ludCgpLCBzID0gZWRnZUFycmF5W2pdLnRhcmdldEVuZHBvaW50KCk7XG5cdFx0XHRpZiAoZG9lc0ludGVyc2VjdChwLngsIHAueSwgcS54LCBxLnksIHIueCwgci55LCBzLngsIHMueSkpIHtcblx0XHRcdFx0Y3Jvc3NlcysrO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRyZXR1cm4gY3Jvc3Nlcztcbn07XG5cbmxldCBmaW5kTnVtYmVyT2ZPdmVybGFwcGluZ05vZGVzID0gZnVuY3Rpb24oY3kpIHtcblx0bGV0IGRvZXNPdmVybGFwID0gZnVuY3Rpb24obm9kZSwgb3RoZXJOb2RlKSB7XG5cdFx0bGV0IGJiID0gbm9kZS5ib3VuZGluZ0JveCgpLCBiYk90aGVyID0gb3RoZXJOb2RlLmJvdW5kaW5nQm94KCk7XG5cdFx0cmV0dXJuICEoYmJPdGhlci54MSA+IGJiLngyIHx8IGJiT3RoZXIueDIgPCBiYi54MSB8fCBiYk90aGVyLnkxID4gYmIueTIgfHwgYmJPdGhlci55MiA8IGJiLnkxKTtcblx0fTtcblxuXHRsZXQgb3ZlcmxhcHMgPSAwO1xuXHRsZXQgbm9kZUFycmF5ID0gY3kubm9kZXMoKS50b0FycmF5KCk7XG5cblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBub2RlQXJyYXkubGVuZ3RoOyBpKyspIHtcblx0XHRsZXQgbm9kZSA9IG5vZGVBcnJheVtpXTtcblx0XHRmb3IgKGxldCBqID0gaSArIDE7IGogPCBub2RlQXJyYXkubGVuZ3RoOyBqKyspIHtcblx0XHRcdGxldCBvdGhlck5vZGUgPSBub2RlQXJyYXlbal07XG5cdFx0XHRpZiAoZG9lc092ZXJsYXAobm9kZSwgb3RoZXJOb2RlKSkge1xuXHRcdFx0XHRvdmVybGFwcysrO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRyZXR1cm4gb3ZlcmxhcHM7XG59O1xuXG5sZXQgZ2V0VG90YWxBcmVhID0gZnVuY3Rpb24oY3kpIHtcblx0bGV0IGJiID0gY3kuZWxlbWVudHMoKS5ib3VuZGluZ0JveCgpO1xuXHRyZXR1cm4gYmIudyAqIGJiLmg7XG59XG5cbmxldCBnZXRUb3RhbEVkZ2VMZW5ndGggPSBmdW5jdGlvbihjeSkge1xuXHRsZXQgZ2V0RGlzdGFuY2UgPSBmdW5jdGlvbihwLCBxKSB7XG5cdFx0bGV0IGR4ID0gcS54IC0gcC54LCBkeSA9IHEueSAtIHAueTtcblx0XHRyZXR1cm4gTWF0aC5zcXJ0KGR4ICogZHggKyBkeSAqIGR5KTtcblx0fTtcblxuXHRsZXQgdG90YWxMZW5ndGggPSAwO1xuXHRsZXQgZWRnZUFycmF5ID0gY3kuZWRnZXMoKS50b0FycmF5KCk7XG5cblx0Zm9yIChsZXQgZWRnZSBvZiBlZGdlQXJyYXkpIHtcblx0XHRsZXQgcCA9IGVkZ2Uuc291cmNlRW5kcG9pbnQoKSwgcSA9IGVkZ2UudGFyZ2V0RW5kcG9pbnQoKTtcblx0XHR0b3RhbExlbmd0aCArPSBnZXREaXN0YW5jZShwLCBxKTtcblx0fVxuXHRyZXR1cm4gdG90YWxMZW5ndGg7XG59O1xuXG5sZXQgZ2V0QXZlcmFnZUVkZ2VMZW5ndGggPSBmdW5jdGlvbihjeSkge1xuXHRyZXR1cm4gZ2V0VG90YWxFZGdlTGVuZ3RoKGN5KSAvIGN5LmVkZ2VzKCkubGVuZ3RoO1xufTtcblxubGV0IGRpZmZlcmVuY2VNZXRyaWNzID0gZnVuY3Rpb24oY3ksIG90aGVyQ3kpIHtcblx0Ly8gYWxpZ25cblx0Y3kuZml0KDUwKTsgb3RoZXJDeS5maXQoNTApOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cblx0aWYgKGN5Lnpvb20oKSA+IG90aGVyQ3kuem9vbSgpKXtcblx0XHRjeS56b29tKG90aGVyQ3kuem9vbSgpKTsgY3kucGFuKG90aGVyQ3kucGFuKCkpO1xuXHR9IGVsc2Uge1xuXHRcdG90aGVyQ3kuem9vbShjeS56b29tKCkpOyBvdGhlckN5LnBhbihjeS5wYW4oKSk7XG5cdH1cblxuXHRyZXR1cm4ge1xuXHRcdGF2ZXJhZ2VEaXN0YW5jZUJldHdlZW5HcmFwaHM6IGdldEF2ZXJhZ2VEaXN0YW5jZUJldHdlZW5HcmFwaHMoY3ksIG90aGVyQ3kpLFxuXHRcdFx0b3J0aG9nb25hbE9yZGVyaW5nOiBvcnRob2dvbmFsT3JkZXJpbmcoY3ksIG90aGVyQ3kpLFxuXHR9O1xufTtcblxubGV0IGdldEF2ZXJhZ2VEaXN0YW5jZUJldHdlZW5HcmFwaHMgPSBmdW5jdGlvbihjeSwgb3RoZXJDeSkge1xuXHRsZXQgZ2V0RGlzdGFuY2UgPSBmdW5jdGlvbihwLCBxKSB7XG5cdFx0bGV0IGR4ID0gcS54IC0gcC54LCBkeSA9IHEueSAtIHAueTtcblx0XHRyZXR1cm4gTWF0aC5zcXJ0KGR4ICogZHggKyBkeSAqIGR5KTtcblx0fTtcblxuXHRsZXQgdG90YWxEaXN0YW5jZSA9IDAsIG51bWJlck9mTm9kZXMgPSAwO1xuXG5cdGN5Lm5vZGVzKCkuZm9yRWFjaChmdW5jdGlvbihlbGUpIHtcblx0XHRsZXQgb3RoZXJFbGUgPSBvdGhlckN5LmdldEVsZW1lbnRCeUlkKGVsZS5pZCgpKTtcblx0XHRpZiAob3RoZXJFbGUubGVuZ3RoKSB7XG5cdFx0XHRudW1iZXJPZk5vZGVzKys7XG5cdFx0XHR0b3RhbERpc3RhbmNlICs9IGdldERpc3RhbmNlKGVsZS5yZW5kZXJlZFBvc2l0aW9uKCksIG90aGVyRWxlLnJlbmRlcmVkUG9zaXRpb24oKSk7XG5cdFx0fVxuXHR9KTtcblx0cmV0dXJuIG51bWJlck9mTm9kZXMgPyB0b3RhbERpc3RhbmNlIC8gbnVtYmVyT2ZOb2RlcyA6IDA7XG59O1xuXG5sZXQgb3J0aG9nb25hbE9yZGVyaW5nID0gZnVuY3Rpb24oY3ksIG90aGVyQ3kpIHtcblx0bGV0IGNhbGNFZGdlQW5nbGUgPSBmdW5jdGlvbihlZGdlKSB7XG5cdFx0bGV0IGR4ID0gZWRnZS50YXJnZXRFbmRwb2ludCgpLnggLSBlZGdlLnNvdXJjZUVuZHBvaW50KCkueDtcblx0XHRsZXQgZHkgPSBlZGdlLnRhcmdldEVuZHBvaW50KCkueSAtIGVkZ2Uuc291cmNlRW5kcG9pbnQoKS55O1xuXHRcdGxldCBhbmdsZSA9IE1hdGguYXRhbjIoZHgsIGR5KTtcblx0XHRyZXR1cm4gYW5nbGUgPCAwID8gYW5nbGUgKyAyICogTWF0aC5QSSA6IGFuZ2xlO1xuXHR9O1xuXG5cdGxldCBnZXRXZWlnaHQgPSBmdW5jdGlvbih0aGV0YSwgbG93ZXJCb3VuZCwgdXBwZXJCb3VuZCkge1xuXHRcdGlmICgodGhldGEgJSBNYXRoLlBJKSA+IE1hdGguUEkgLyA0KSB7XG5cdFx0XHRsZXQgc2xvcGUgPSAtNCAvIE1hdGguUEksIGhlaWdodCA9IDIsIHdpZHRoID0gTWF0aC5QSSAvIDI7IFxuXHRcdFx0bGV0IHggPSBNYXRoLmZsb29yKHVwcGVyQm91bmQgLyB3aWR0aCkgLSBNYXRoLmZsb29yKGxvd2VyQm91bmQgLyB3aWR0aCk7XG5cdFx0XHRsZXQgYXJlYSA9IDA7XG5cdFx0XHRsZXQgbG93ZXJCb3VuZFkgPSAyICsgKGxvd2VyQm91bmQgJSB3aWR0aCkgKiBzbG9wZSwgdXBwZXJCb3VuZFkgPSAyICsgKHVwcGVyQm91bmQgJSB3aWR0aCkgKiBzbG9wZTtcblxuXHRcdFx0aWYgKHggPiAwKSB7XG5cdFx0XHRcdGFyZWEgPSB3aWR0aCAqICh4IC0gMSk7XG5cdFx0XHRcdGFyZWEgKz0gKHdpZHRoIC0gKGxvd2VyQm91bmQgJSB3aWR0aCkpICogbG93ZXJCb3VuZFkgLyAyO1xuXHRcdFx0XHRhcmVhICs9IChoZWlnaHQgKyB1cHBlckJvdW5kWSkgLyAyICogKHVwcGVyQm91bmQgJSB3aWR0aCk7IFxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0YXJlYSArPSAobG93ZXJCb3VuZFkgKyB1cHBlckJvdW5kWSkgLyAyICogKCh1cHBlckJvdW5kIC0gbG93ZXJCb3VuZCkgJSB3aWR0aCk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gYXJlYTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0bGV0IHNsb3BlID0gNCAvIE1hdGguUEksIGhlaWdodCA9IDIsIHdpZHRoID0gTWF0aC5QSSAvIDI7XG5cdFx0XHRsZXQgeCA9IE1hdGguZmxvb3IodXBwZXJCb3VuZCAvIHdpZHRoKSAtIE1hdGguZmxvb3IobG93ZXJCb3VuZCAvIHdpZHRoKTtcblx0XHRcdGxldCBhcmVhID0gd2lkdGggKiBNYXRoLmZsb29yKCh1cHBlckJvdW5kIC0gbG93ZXJCb3VuZCkgLyB3aWR0aCk7XG5cdFx0XHRsZXQgbG93ZXJCb3VuZFkgPSAobG93ZXJCb3VuZCAlIHdpZHRoKSAqIHNsb3BlLCB1cHBlckJvdW5kWSA9ICh1cHBlckJvdW5kICUgd2lkdGgpICogc2xvcGU7XG5cblx0XHRcdGlmICh4ID4gMCkge1xuXHRcdFx0XHRhcmVhID0gd2lkdGggKiAoeCAtIDEpO1xuXHRcdFx0XHRhcmVhICs9ICh3aWR0aCAtIChsb3dlckJvdW5kICUgd2lkdGgpKSAqIChoZWlnaHQgKyBsb3dlckJvdW5kWSkgLyAyO1xuXHRcdFx0XHRhcmVhICs9IHVwcGVyQm91bmRZICogKHVwcGVyQm91bmQgJSB3aWR0aCkgLyAyIDsgXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRhcmVhICs9IChsb3dlckJvdW5kWSArIHVwcGVyQm91bmRZKSAvIDIgKiAoKHVwcGVyQm91bmQgLSBsb3dlckJvdW5kKSAlIHdpZHRoKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBhcmVhO1xuXHRcdH1cblx0fTtcblxuXHRsZXQgZ2V0T3JkZXIgPSBmdW5jdGlvbihlZGdlLCBvdGhlckVkZ2UpIHtcblx0XHRsZXQgdG90YWxXZWlnaHQgPSAwLCBhbmdsZSA9IGNhbGNFZGdlQW5nbGUoZWRnZSksIG90aGVyQW5nbGUgPSBjYWxjRWRnZUFuZ2xlKG90aGVyRWRnZSk7XG5cblx0XHRpZiAoYW5nbGUgPiBvdGhlckFuZ2xlKSB7XG5cdFx0XHRbYW5nbGUsIG90aGVyQW5nbGVdID0gW290aGVyQW5nbGUsIGFuZ2xlXTtcblx0XHR9XG5cdFx0bGV0IHVwcGVyQm91bmQgPSAwO1xuXHRcdHdoaWxlICh1cHBlckJvdW5kICE9IG90aGVyQW5nbGUpIHtcblx0XHRcdHVwcGVyQm91bmQgPSBNYXRoLlBJIC8gNCAqIChNYXRoLmZsb29yKGFuZ2xlIC8gKE1hdGguUEkgLyA0KSkgKyAxKTtcblxuXHRcdFx0aWYgKHVwcGVyQm91bmQgPiBvdGhlckFuZ2xlKSB7XG5cdFx0XHRcdHVwcGVyQm91bmQgPSBvdGhlckFuZ2xlO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoYW5nbGUgJSBNYXRoLlBJIC8gMiA+IE1hdGguUEkgLyA0KSB7XG5cdFx0XHRcdHRvdGFsV2VpZ2h0ICs9IGdldFdlaWdodCg1LCBhbmdsZSwgdXBwZXJCb3VuZCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0b3RhbFdlaWdodCArPSBnZXRXZWlnaHQoMCwgYW5nbGUsIHVwcGVyQm91bmQpO1xuXHRcdFx0fVxuXG5cdFx0XHRhbmdsZSA9IHVwcGVyQm91bmQ7XG5cblx0XHR9XG5cdFx0cmV0dXJuIHRvdGFsV2VpZ2h0O1xuXHR9O1xuXG5cdGxldCB0b3RhbEFuZ2xlID0gMCwgbnVtYmVyT2ZFZGdlcyA9IDA7XG5cblx0Y3kuZWRnZXMoKS5mb3JFYWNoKGZ1bmN0aW9uKGVsZSkge1xuXHRcdGxldCBvdGhlckVsZSA9IG90aGVyQ3kuZ2V0RWxlbWVudEJ5SWQoZWxlLmlkKCkpO1xuXHRcdGlmIChvdGhlckVsZS5sZW5ndGgpIHtcblx0XHRcdG51bWJlck9mRWRnZXMrKztcblx0XHRcdHRvdGFsQW5nbGUgKz0gTWF0aC5taW4oZ2V0T3JkZXIoZWxlLCBvdGhlckVsZSksIGdldE9yZGVyKG90aGVyRWxlLCBlbGUpKTtcblx0XHR9XG5cdH0pO1xuXHRjb25zb2xlLmxvZyh0b3RhbEFuZ2xlKTtcblx0cmV0dXJuIG51bWJlck9mRWRnZXMgPyB0b3RhbEFuZ2xlIC8gbnVtYmVyT2ZFZGdlcyA6IDA7XG59O1xuIiwiY29uc3QgaW1wbCA9IHJlcXVpcmUoJy4vbGF5b3V0LWV2YWx1YXRpb24nKTtcblxuLy8gcmVnaXN0ZXJzIHRoZSBleHRlbnNpb24gb24gYSBjeXRvc2NhcGUgbGliIHJlZlxubGV0IHJlZ2lzdGVyID0gZnVuY3Rpb24oIGN5dG9zY2FwZSApe1xuICBpZiggIWN5dG9zY2FwZSApeyByZXR1cm47IH0gLy8gY2FuJ3QgcmVnaXN0ZXIgaWYgY3l0b3NjYXBlIHVuc3BlY2lmaWVkXG5cbiAgY3l0b3NjYXBlKCAnY29yZScsICdsYXl2bycsIGltcGwgKTsgLy8gcmVnaXN0ZXIgd2l0aCBjeXRvc2NhcGUuanNcbn07XG5cbmlmKCB0eXBlb2YgY3l0b3NjYXBlICE9PSAndW5kZWZpbmVkJyApeyAvLyBleHBvc2UgdG8gZ2xvYmFsIGN5dG9zY2FwZSAoaS5lLiB3aW5kb3cuY3l0b3NjYXBlKVxuICByZWdpc3RlciggY3l0b3NjYXBlICk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gcmVnaXN0ZXI7XG4iXSwic291cmNlUm9vdCI6IiJ9